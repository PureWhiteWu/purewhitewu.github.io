<!DOCTYPE html><html class="theme-next mist use-motion" lang="zh-Hans"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><script src="/lib/pace/pace.min.js?v=1.0.2"></script><link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2"><link rel="stylesheet" href="/lib/Han/dist/han.min.css?v=3.3"><meta name="google-site-verification" content="Xg_Hnp9ie-Rq7-zLPdd3c9dQtR_0N845ue4QaK8jvL4"><link rel="stylesheet" href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5"><link rel="stylesheet" href="https://use.fontawesome.com/11d7545abd.css"><link rel="stylesheet" href="/css/main.css?v=7.0.1"><link rel="apple-touch-icon" sizes="180x180" href="https://static.purewhite.io/favicon.jpg?v=7.0.1"><link rel="icon" type="image/png" sizes="32x32" href="https://static.purewhite.io/favicon.jpg?v=7.0.1"><link rel="icon" type="image/png" sizes="16x16" href="https://static.purewhite.io/favicon.jpg?v=7.0.1"><link rel="mask-icon" href="https://static.purewhite.io/favicon.jpg?v=7.0.1" color="#222"><meta property="fb:admins" content="100008177860594"><meta property="fb:app_id" content="761738893983932"><script id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Mist",version:"7.0.1",sidebar:{position:"left",display:"post",offset:12,b2t:!1,scrollpercent:!0,onmobile:!1,dimmer:!1},fancybox:!0,fastclick:!0,lazyload:!0,tabs:!0,motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},algolia:{applicationID:"ZP9482CZD3",apiKey:"d26207a3ce8de9fe98e7af4215425c93",indexName:"Blog",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><meta name="description" content="Kubernetes中有很多积木（Building Blocks），比如object model，pod，rs，deployment，namespace之类，这些都是kubernetes中很重要的东西。"><meta name="keywords" content="后端,架构,kubernetes"><meta property="og:type" content="article"><meta property="og:title" content="Kubernetes Building Blocks"><meta property="og:url" content="https://purewhite.io/2017/12/22/kubernetes-building-blocks/index.html"><meta property="og:site_name" content="Pure White"><meta property="og:description" content="Kubernetes中有很多积木（Building Blocks），比如object model，pod，rs，deployment，namespace之类，这些都是kubernetes中很重要的东西。"><meta property="og:locale" content="zh-Hans"><meta property="og:image" content="https://static.purewhite.io/images/2017-12-22-70B197CF-63EA-401C-B029-AFC9F9271D91.png"><meta property="og:image" content="https://static.purewhite.io/images/2017-12-22-38D8B067-9AD2-4CE0-85C5-70C3D5538FB0.png"><meta property="og:image" content="https://static.purewhite.io/images/2017-12-22-5594660A-4922-497F-9BB6-69CDE96238B3.png"><meta property="og:image" content="https://static.purewhite.io/images/2017-12-22-9DCAECB6-54CF-4789-94B8-4332BABE4B53.png"><meta property="og:image" content="https://static.purewhite.io/images/2017-12-22-1A74F83F-00D9-4954-9737-D6C1BBAE3EF3.png"><meta property="og:image" content="https://static.purewhite.io/images/2017-12-22-D9667D97-B328-4C19-AA9F-FD9E7CDEDD65.png"><meta property="og:image" content="https://static.purewhite.io/images/2017-12-22-652F4886-8F15-4C27-9DDF-8C1DA7D1DF11.png"><meta property="og:image" content="https://static.purewhite.io/images/2017-12-22-C8E9D1AC-E8F8-4544-8DB0-F4EAA6905F56.png"><meta property="og:updated_time" content="2019-03-18T06:14:05.277Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Kubernetes Building Blocks"><meta name="twitter:description" content="Kubernetes中有很多积木（Building Blocks），比如object model，pod，rs，deployment，namespace之类，这些都是kubernetes中很重要的东西。"><meta name="twitter:image" content="https://static.purewhite.io/images/2017-12-22-70B197CF-63EA-401C-B029-AFC9F9271D91.png"><link rel="alternate" href="/atom.xml" title="Pure White" type="application/atom+xml"><link rel="canonical" href="https://purewhite.io/2017/12/22/kubernetes-building-blocks/"><script id="page.configurations">CONFIG.page={sidebar:""}</script><title>Kubernetes Building Blocks | Pure White</title><script>window.fbAsyncInit=function(){FB.init({appId:"761738893983932",xfbml:!0,version:"v2.10"})},function(e,n,t){var o,c=e.getElementsByTagName(n)[0];e.getElementById(t)||((o=e.createElement(n)).id=t,o.src="//connect.facebook.net/zh_Hans/sdk.js",c.parentNode.insertBefore(o,c))}(document,"script","facebook-jssdk")</script><script async src="//www.googletagmanager.com/gtag/js?id=[object Object]"></script><script>var host=window.location.hostname;if("localhost"!==host){function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-98194081-1")}</script><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?a29bb47eea3aa0d952f7bd979b29fa84";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-title,.use-motion .comments,.use-motion .menu-item,.use-motion .motion-element,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .logo,.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans"><div class="container sidebar-position-left page-post-detail"><div class="headband"></div><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">Pure White</span><span class="logo-line-after"><i></i></span></a></div><h1 class="site-subtitle" itemprop="description">主业写bug，副业debug</h1></div><div class="site-nav-toggle"> <button aria-label="Toggle navigation bar"><span class="btn-bar"></span><span class="btn-bar"></span><span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-首页"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br>首页</a></li><li class="menu-item menu-item-关于我"><a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i><br>关于我</a></li><li class="menu-item menu-item-标签"><a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br>标签</a></li><li class="menu-item menu-item-分类"><a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br>分类</a></li><li class="menu-item menu-item-归档"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br>归档</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i><br>Search</a></li></ul><div class="site-search"><div class="algolia-popup popup search-popup"><div class="algolia-search"><div class="algolia-search-input-icon"><i class="fa fa-search"></i></div><div class="algolia-search-input" id="algolia-search-input"></div></div><div class="algolia-results"><div id="algolia-stats"></div><div id="algolia-hits"></div><div id="algolia-pagination" class="algolia-pagination"></div></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div></div></nav></div></header> <a href="https://github.com/PureWhiteWu" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewbox="0 0 250 250" style="fill:#222;color:#fff;position:absolute;top:0;border:0;right:0" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"/></svg></a><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><div class="reading-progress-bar"></div><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://purewhite.io/2017/12/22/kubernetes-building-blocks/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="Pure White"><meta itemprop="description" content="青春不是年华，是心境；<br />青春不是桃面、丹唇、柔膝，<br />而是深沉的意志、恢弘的想象、<br />炽热的感情。"><meta itemprop="image" content="https://static.purewhite.io/avatar.jpg"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Pure White"></span><header class="post-header"><h2 class="post-title" itemprop="name headline">Kubernetes Building Blocks</h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">Posted on</span> <time title="Created: 2017-12-22 23:44:37" itemprop="dateCreated datePublished" datetime="2017-12-22T23:44:37+08:00">2017-12-22</time> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i></span> <span class="post-meta-item-text">Edited on</span> <time title="Modified: 2019-03-18 14:14:05" itemprop="dateModified" datetime="2019-03-18T14:14:05+08:00">2019-03-18</time></span> <span class="post-category"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/kubernetes/" itemprop="url" rel="index"><span itemprop="name">kubernetes</span></a></span></span> <span class="post-comments-count"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-comment-o"></i></span> <span class="post-meta-item-text">Comments:</span><a href="/2017/12/22/kubernetes-building-blocks/#comments" itemprop="discussionUrl"><span class="post-comments-count disqus-comment-count" data-disqus-identifier="2017/12/22/kubernetes-building-blocks/" itemprop="commentCount"></span></a></span> <span id="/2017/12/22/kubernetes-building-blocks/" class="leancloud_visitors" data-flag-title="Kubernetes Building Blocks"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span> <span class="post-meta-item-text">Views:</span><span class="leancloud-visitors-count"></span></span><div class="post-symbolscount"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i></span> <span class="post-meta-item-text">Symbols count in article:</span> <span title="Symbols count in article">3.5k</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-clock-o"></i></span> <span class="post-meta-item-text">Reading time &asymp;</span> <span title="Reading time">3 mins.</span></div></div></header><div class="post-body han-init-context" itemprop="articleBody"><p>Kubernetes中有很多积木（Building Blocks），比如object model，pod，rs，deployment，namespace之类，这些都是kubernetes中很重要的东西。</p><a id="more"></a><h1 id="Kubernetes-Object-Model"><a href="#Kubernetes-Object-Model" class="headerlink" title="Kubernetes Object Model"></a>Kubernetes Object Model</h1><p>kubernetes有一个非常完善的对象模型，kubernetes集群可以通过这个对象模型来表现出不同的持久化的整体，比如：</p><ul><li>我们是在哪个node上运行哪个容器化的应用程序？</li><li>应用程序资源消耗</li><li>应用程序不同的策略</li></ul><p>对于每个对象，我们用<code>spec</code>这个field声明我们期望的状态，随后kubernetes会通过<code>status</code>这个field记录对象实际的状态并加以管理。随后，kubernetes的controller manager会想办法让这个对象实际的状态和我们声明期望的状态相同。</p><p>kubernetes中的例子比如：Pods，Deployments，ReplicaSets之类。</p><p>如果我们要创建一个对象，我们需要把<code>spec</code>这个field提供给API Server，这个field会描述我们期望的状态以及一些基础的信息，比如名称。创建对象的API请求必须有<code>spec</code>这个field以及其它详细信息，并且需要是JSON的格式。一般情况下，我们用yaml格式来提供一个对象的声明，kubectl会把这个声明转换成JSON格式，然后传给API Server。</p><p>下面是一个Deployment对象的例子：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">apps/v1beta1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Deployment</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line"><span class="attr">  name:</span> <span class="string">nginx-deployment</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line"><span class="attr">    replicas:</span> <span class="number">3</span></span><br><span class="line"><span class="attr">  template:</span></span><br><span class="line"><span class="attr">    metadata:</span></span><br><span class="line"><span class="attr">      labels:</span></span><br><span class="line"><span class="attr">        app:</span> <span class="string">nginx</span></span><br><span class="line"><span class="attr">    spec:</span></span><br><span class="line"><span class="attr">      containers:</span></span><br><span class="line"><span class="attr">             - name:</span> <span class="string">nginx</span></span><br><span class="line"><span class="attr">        image:</span> <span class="attr">nginx:1.7.9</span></span><br><span class="line"><span class="attr">        ports:</span></span><br><span class="line"><span class="attr">        - containerPort:</span> <span class="number">80</span></span><br></pre></td></tr></table></figure><p>插播一条广告：</p><blockquote><h3 id="Apps"><a href="#Apps" class="headerlink" title="Apps"></a>Apps</h3><p>The core workloads API, which is composed of the DaemonSet, Deployment, ReplicaSet, and StatefulSet kinds, has been promoted to GA stability in the apps/v1 group version. As such, the apps/v1beta2 group version is deprecated, and all new code should use the kinds in the apps/v1 group version.</p></blockquote><p>接着说，apiVersion指定了我们调用的api的endpoint；通过kind field，我们指定了我们要创建的对象的类型；通过metadata，我们给对象附加上了最基本的信息，比如名字；你可以发现这里面有两个<code>spec</code>的field（<code>spec</code>和<code>spec.template.spec</code>），通过 <code>spec</code>，我们定义了我们对deployment的期望状态，在我们的例子中，我们想要确认，在任何时候，都有至少3个pod在运行。我们再在<code>spec.template.spec</code>里面定义我们要运行的每个pod都应该是什么状态，所以这就是为啥这里会有两个spec的原因。</p><p>一旦这个对象被创建了，kubernetes会直接给对象添加一个<code>status</code>的field，如下：</p><p><img src="https://static.purewhite.io/images/2017-12-22-70B197CF-63EA-401C-B029-AFC9F9271D91.png" alt="70B197CF-63EA-401C-B029-AFC9F9271D91"></p><h1 id="Pods"><a href="#Pods" class="headerlink" title="Pods"></a>Pods</h1><p>Pod是kubernetes中最简单也是最小的一个对象，是kubernetes部署的一个单元，代表了应用的一个单一实例。一个Pod是一个或者多个容器的逻辑上的集合，这些容器拥有以下的特性：</p><ul><li>在同一个host上一起进行调度</li><li>共享同一个network namespace</li><li>挂载同样的external storage（volumes）</li></ul><p><img src="https://static.purewhite.io/images/2017-12-22-38D8B067-9AD2-4CE0-85C5-70C3D5538FB0.png" alt="38D8B067-9AD2-4CE0-85C5-70C3D5538FB0"></p><p>Pod并非一个持久化的东西，很有可能突然挂了，并且没有能力自我修复，这就是为啥我们把它们和controller一起用，这样可以来控制pod的replica，容错，自我修复等等。比较有名的例子比如Deployments，ReplicaSets等。我们通过把Pod的定义（specification，也就是<code>spec</code>）附加到别的对象（也就是之前用的<code>template.spec</code>）来完成。</p><h1 id="Labels"><a href="#Labels" class="headerlink" title="Labels"></a>Labels</h1><p>Labels都是键值对，这些键值对可以被attach到kubernetes的对象上，比如Pod。Labels一般被用来组织和选择一些符合条件的对象。label不提供唯一性。</p><p><img src="https://static.purewhite.io/images/2017-12-22-5594660A-4922-497F-9BB6-69CDE96238B3.png" alt="5594660A-4922-497F-9BB6-69CDE96238B3"></p><p>通过这个图片，我们可以看到我们用了两个label：<code>app</code>和<code>env</code>。基于我们的需求，我们可以给我们的pod不同的值。</p><h1 id="Label-Selectors"><a href="#Label-Selectors" class="headerlink" title="Label Selectors"></a>Label Selectors</h1><p>通过Label Selectors，我们可以选择一系列的对象，Kubernetes支持两种Selector类型：</p><h3 id="Equality-Based-Selectors"><a href="#Equality-Based-Selectors" class="headerlink" title="Equality-Based Selectors"></a>Equality-Based Selectors</h3><p>顾名思义，这种selector通过 <code>==</code> 或者 <code>!=</code> 来进行选择，比如我们选择一个 <code>env==dev</code> 的对象，就会找出所有有env label，并且值为dev的。</p><h3 id="Set-Based-Selectors"><a href="#Set-Based-Selectors" class="headerlink" title="Set-Based Selectors"></a>Set-Based Selectors</h3><p>这种selector支持通过一系列的值来进行过滤，比如通过<code>in</code>, <code>notin</code>和<code>exist</code>。</p><p>举例：<code>env in (dev, qa)</code></p><p><img src="https://static.purewhite.io/images/2017-12-22-9DCAECB6-54CF-4789-94B8-4332BABE4B53.png" alt="9DCAECB6-54CF-4789-94B8-4332BABE4B53"></p><h1 id="Replication-Controllers"><a href="#Replication-Controllers" class="headerlink" title="Replication Controllers"></a>Replication Controllers</h1><p>一个 ReplicationController（rc）是master node上Controller Manager的一部分，主要作用是保证每个pod的replica都达到了预期值。不然的话会通过杀死或者新建pod的办法来达到。不过现在已经被ReplicaSet(rs)取代了。</p><h1 id="Replica-Sets"><a href="#Replica-Sets" class="headerlink" title="Replica Sets"></a>Replica Sets</h1><p>Replica Set是下一代的Replication Controller，好处在于同时支持equality 和 set based selector（rc只支持equality-based）。目前这是唯一的区别。</p><p>Rs可以单独使用，不过一般是配合deployment一起用。Deployment会自动创建rs来管理下面的pod。</p><h1 id="Deployment"><a href="#Deployment" class="headerlink" title="Deployment"></a>Deployment</h1><p>deployment提供了对于pod和rs的陈述性更新。DeploymentController是master node上Controller Manager的一部分，作用和Controller manager别的一样——确保当前的状态和期望的状态相同。</p><p>在下面这个例子中，我们的deployment创建了一个 rs A，然后rs A又创建了3个pod，并且在每个pod中，都有一个跑了nginx:1.7.9镜像的容器。</p><p><img src="https://static.purewhite.io/images/2017-12-22-1A74F83F-00D9-4954-9737-D6C1BBAE3EF3.png" alt="1A74F83F-00D9-4954-9737-D6C1BBAE3EF3"></p><p>接下来，在下一个deployment中，我们修改了pod的template，把nginx从1.7.9升级到了1.9.1。因为我们升级了期望的状态，所以deployment会创建一个新的rs B，这个过程被称为Deployment rollout：</p><p><img src="https://static.purewhite.io/images/2017-12-22-D9667D97-B328-4C19-AA9F-FD9E7CDEDD65.png" alt="D9667D97-B328-4C19-AA9F-FD9E7CDEDD65"></p><p>当rs B创建完毕的时候，deployment开始指向它：</p><p><img src="https://static.purewhite.io/images/2017-12-22-652F4886-8F15-4C27-9DDF-8C1DA7D1DF11.png" alt="652F4886-8F15-4C27-9DDF-8C1DA7D1DF11"></p><p>在rs之上，deployment提供了很多特性比如recording，通过这个特性，如果说更新出错，或者更新后的应用出了bug，我们可以rollback到原先的状态。</p><h1 id="Namespaces"><a href="#Namespaces" class="headerlink" title="Namespaces"></a>Namespaces</h1><p>如果我们有无数个用户，我们想把这些用户组织到不同的team或者project，我们可以通过namespace把kubernetes集群分成好多个小集群。所有在namespace中创建的resources/objects都是唯一的，不会跨命名空间。</p><p>一般来说，k8s会有两个默认namespace：kube-system和default。kube-system一般会用来放一些kubernetes系统的组件，default会用来放一些属于其它namespace的对象。我们默认情况下是会连接到default命名空间。kube-public是一个特殊的namespace，可以被所有的用户读，一般用于特殊情况比如初始化一个集群。</p><p>我们可以通过使用资源配额（Resource Quotas）来限制每个命名空间的资源。</p><p>最后再插播一条广告：</p><blockquote><p><img src="https://static.purewhite.io/images/2017-12-22-C8E9D1AC-E8F8-4544-8DB0-F4EAA6905F56.png" alt="C8E9D1AC-E8F8-4544-8DB0-F4EAA6905F56"></p></blockquote></div><div class="popular-posts-header">Related Posts</div><ul class="popular-posts"><li class="popular-posts-item"><div class="popular-posts-title"><a href="/2018/01/17/helm-provide-value/" rel="bookmark">Helm中如何传递value</a></div></li><li class="popular-posts-item"><div class="popular-posts-title"><a href="/2017/12/22/install-kubernetes/" rel="bookmark">Kubernetes安装</a></div></li><li class="popular-posts-item"><div class="popular-posts-title"><a href="/2017/12/28/kubernetes-ingress/" rel="bookmark">kubernetes 中的 ingress</a></div></li><li class="popular-posts-item"><div class="popular-posts-title"><a href="/2017/12/28/kubernetes-configmap-and-secret/" rel="bookmark">kubernetes 中的 ConfigMap 和 Secret</a></div></li><li class="popular-posts-item"><div class="popular-posts-title"><a href="/2017/12/22/kubernetes-concepts/" rel="bookmark">Kubernetes 架构 Overview</a></div></li></ul><div><div style="padding:10px 0;margin:20px auto;width:90%;text-align:center"><div>请博主喝杯咖啡~</div> <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById(&quot;QR&quot;); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}"> <span>Donate</span></button><div id="QR" style="display:none"><div id="wechat" style="display:inline-block"> <img id="wechat_qr" src="https://static.purewhite.io/wechat_pay.jpeg" alt="Pure White WeChat Pay"><p>WeChat Pay</p></div><div id="alipay" style="display:inline-block"> <img id="alipay_qr" src="https://static.purewhite.io/alipay.jpeg" alt="Pure White Alipay"><p>Alipay</p></div></div></div></div><footer class="post-footer"><div class="post-tags"> <a href="/tags/kubernetes/" rel="tag"># kubernetes</a> <a href="/tags/运维/" rel="tag"># 运维</a> <a href="/tags/后端/" rel="tag"># 后端</a> <a href="/tags/架构/" rel="tag"># 架构</a> <a href="/tags/docker/" rel="tag"># docker</a> <a href="/tags/linux/" rel="tag"># linux</a></div><div class="post-widgets"><div class="wp_rating"><div id="wpac-rating"></div></div></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/2017/12/22/install-kubernetes/" rel="next" title="Kubernetes安装"><i class="fa fa-chevron-left"></i> Kubernetes安装</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"> <a href="/2017/12/23/kubernetes-service/" rel="prev" title="kubernetes中的Service">kubernetes中的Service<i class="fa fa-chevron-right"></i></a></div></div></footer></div></article></div></div><div class="comments" id="comments"><div id="disqus_thread"><noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript></div></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span><span class="sidebar-toggle-line sidebar-toggle-line-middle"></span><span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap"> Table of Contents</li><li class="sidebar-nav-overview" data-target="site-overview-wrap"> Overview</li></ul><div class="site-overview-wrap sidebar-panel"><div class="site-overview"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" src="https://static.purewhite.io/avatar.jpg" alt="Pure White"><p class="site-author-name" itemprop="name">Pure White</p><p class="site-description motion-element" itemprop="description">青春不是年华，是心境；<br>青春不是桃面、丹唇、柔膝，<br>而是深沉的意志、恢弘的想象、<br>炽热的感情。</p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"> <a href="/archives"><span class="site-state-item-count">44</span> <span class="site-state-item-name">posts</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/index.html"><span class="site-state-item-count">15</span> <span class="site-state-item-name">categories</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/index.html"><span class="site-state-item-count">29</span> <span class="site-state-item-name">tags</span></a></div></nav><div class="feed-link motion-element"><a href="/atom.xml" rel="alternate"><i class="fa fa-rss"></i> RSS</a></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/PureWhiteWu" title="GitHub &rarr; https://github.com/PureWhiteWu" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i> GitHub</a></span><span class="links-of-author-item"><a href="mailto:daniel48@126.com" title="E-Mail &rarr; mailto:daniel48@126.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i> E-Mail</a></span><span class="links-of-author-item"><a href="https://twitter.com/PureWhite_Wu" title="Twitter &rarr; https://twitter.com/PureWhite_Wu" rel="noopener" target="_blank"><i class="fa fa-fw fa-twitter"></i> Twitter</a></span><span class="links-of-author-item"><a href="https://www.linkedin.com/in/%E8%BF%AA-%E5%90%B4-846051106/" title="LinkedIn &rarr; https://www.linkedin.com/in/%E8%BF%AA-%E5%90%B4-846051106/" rel="noopener" target="_blank"><i class="fa fa-fw fa-linkedin"></i> LinkedIn</a></span><span class="links-of-author-item"><a href="https://telegram.me/PureWhiteWu" title="Telegram &rarr; https://telegram.me/PureWhiteWu" rel="noopener" target="_blank"><i class="fa fa-fw fa-telegram"></i> Telegram</a></span><span class="links-of-author-item"><a href="http://weibo.com/purewhitewu" title="微博 &rarr; http://weibo.com/purewhitewu" rel="noopener" target="_blank"><i class="fa fa-fw fa-weibo"></i> 微博</a></span><span class="links-of-author-item"><a href="https://www.zhihu.com/people/PureWhite_Wu" title="知乎 &rarr; https://www.zhihu.com/people/PureWhite_Wu" rel="noopener" target="_blank"><i class="fa fa-fw fa-book"></i> 知乎</a></span><span class="links-of-author-item"><a href="https://static.purewhite.io/wechat.jpeg" title="微信 &rarr; https://static.purewhite.io/wechat.jpeg" rel="noopener" target="_blank"><i class="fa fa-fw fa-weixin"></i> 微信</a></span></div><div class="links-of-blogroll motion-element links-of-blogroll-block"><div class="links-of-blogroll-title"><i class="fa fa-fw fa-link"></i> 友情链接</div><ul class="links-of-blogroll-list"><li class="links-of-blogroll-item"> <a href="http://blog.didispace.com/" title="http://blog.didispace.com/" rel="noopener" target="_blank">程序猿DD</a></li><li class="links-of-blogroll-item"> <a href="http://leoif.me/" title="http://leoif.me/" rel="noopener" target="_blank">leoif</a></li><li class="links-of-blogroll-item"> <a href="http://www.v2ex.com/?r=PureWhiteWu" title="http://www.v2ex.com/?r=PureWhiteWu" rel="noopener" target="_blank">v2ex</a></li></ul></div></div></div><div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Kubernetes-Object-Model"><span class="nav-number">1.</span> <span class="nav-text">Kubernetes Object Model</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Apps"><span class="nav-number">1.0.1.</span> <span class="nav-text">Apps</span></a></li></ol></li></ol><li class="nav-item nav-level-1"><a class="nav-link" href="#Pods"><span class="nav-number">2.</span> <span class="nav-text">Pods</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Labels"><span class="nav-number">3.</span> <span class="nav-text">Labels</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Label-Selectors"><span class="nav-number">4.</span> <span class="nav-text">Label Selectors</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Equality-Based-Selectors"><span class="nav-number">4.0.1.</span> <span class="nav-text">Equality-Based Selectors</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Set-Based-Selectors"><span class="nav-number">4.0.2.</span> <span class="nav-text">Set-Based Selectors</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Replication-Controllers"><span class="nav-number">5.</span> <span class="nav-text">Replication Controllers</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Replica-Sets"><span class="nav-number">6.</span> <span class="nav-text">Replica Sets</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Deployment"><span class="nav-number">7.</span> <span class="nav-text">Deployment</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Namespaces"><span class="nav-number">8.</span> <span class="nav-text">Namespaces</span></a></li></div></div></div></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright"> <a href="http://www.miitbeian.gov.cn" rel="noopener" target="_blank">沪ICP备15051443号-3</a> &copy; 2017 – <span itemprop="copyrightYear">2019</span><span class="with-love" id="animate"><i class="fa fa-user"></i></span> <span class="author" itemprop="copyrightHolder">Pure White</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-area-chart"></i></span> <span class="post-meta-item-text">Symbols count total:</span> <span title="Symbols count total">118k</span></div><div class="powered-by">Powered by <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> v3.8.0</div> <span class="post-meta-divider">|</span><div class="theme-info">Theme – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a> v7.0.1</div><script>!function(){var e=document.createElement("script");e.src="//tajs.qq.com/stats?sId=61888292";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span id="scrollpercent"><span>0</span>%</span></div></div><script>"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script src="/lib/jquery/index.js?v=2.1.3"></script><script src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script><script src="/lib/reading_progress/reading_progress.js"></script><script src="/js/src/utils.js?v=7.0.1"></script><script src="/js/src/motion.js?v=7.0.1"></script><script src="/js/src/schemes/muse.js?v=7.0.1"></script><script src="/js/src/scrollspy.js?v=7.0.1"></script><script src="/js/src/post-details.js?v=7.0.1"></script><script src="/js/src/bootstrap.js?v=7.0.1"></script><script src="/lib/quicklink/dist/quicklink.umd.js"></script><script>
		window.addEventListener('load', () => {
      quicklink({
        timeout: 3000,
        priority: true,
        ignores: [uri => uri.includes('#'), ]
      });
    });
  </script><script id="dsq-count-scr" src="https://blog-zr0zqnlt9p.disqus.com/count.js" async></script><script>var disqus_config=function(){this.page.url="https://purewhite.io/2017/12/22/kubernetes-building-blocks/",this.page.identifier="2017/12/22/kubernetes-building-blocks/",this.page.title="Kubernetes Building Blocks"};function loadComments(){var t=document,e=t.createElement("script");e.src="https://blog-zr0zqnlt9p.disqus.com/embed.js",e.setAttribute("data-timestamp",""+ +new Date),(t.head||t.body).appendChild(e)}$(function(){$("#comments").offset().top-$(window).height()<=0?loadComments():$(window).on("scroll.disqus_scroll",function(){$("#comments").offset().top-$(window).height()-$(window).scrollTop()<60&&($(window).off(".disqus_scroll"),loadComments())})})</script><link rel="stylesheet" href="/lib/algolia-instant-search/instantsearch.min.css"><script src="/lib/algolia-instant-search/instantsearch.min.js"></script><script src="/js/src/algolia-search.js?v=7.0.1"></script><script>
    
    function addCount(Counter) {
      var $visitors = $('.leancloud_visitors');
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();

      Counter('get', '/classes/Counter', { where: JSON.stringify({ url }) })
        .done(function({ results }) {
          if (results.length > 0) {
            var counter = results[0];
            
              var $element = $(document.getElementById(url));
              $element.find('.leancloud-visitors-count').text(counter.time + 1);
            
            Counter('put', '/classes/Counter/' + counter.objectId, JSON.stringify({ time: { '__op': 'Increment', 'amount': 1 } }))
            
              .fail(function ({ responseJSON }) {
                console.log('Failed to save Visitor num, with error message: ' + responseJSON.error);
              })
          } else {
            
              Counter('post', '/classes/Counter', JSON.stringify({ title: title, url: url, time: 1 }))
                .done(function() {
                  var $element = $(document.getElementById(url));
                  $element.find('.leancloud-visitors-count').text(1);
                })
                .fail(function() {
                  console.log('Failed to create');
                });
            
          }
        })
        .fail(function ({ responseJSON }) {
          console.log('LeanCloud Counter Error: ' + responseJSON.code + ' ' + responseJSON.error);
        });
    }
    

    $(function() {
      $.get('https://app-router.leancloud.cn/2/route?appId=' + 'Sa9GIjpR90eFliBWzUAiUp9W-gzGzoHsz')
        .done(function({ api_server }) {
          var Counter = function(method, url, data) {
            return $.ajax({
              method: method,
              url: 'https://' + api_server + '/1.1' + url,
              headers: {
                'X-LC-Id': 'Sa9GIjpR90eFliBWzUAiUp9W-gzGzoHsz',
                'X-LC-Key': 'rSpeP2HoYIdOYJr4p2elMvLn',
                'Content-Type': 'application/json',
              },
              data: data
            });
          };
          
            addCount(Counter);
          
        });
    });
  </script><script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}()</script><script>wpac_init=window.wpac_init||[],wpac_init.push({widget:"Rating",id:8500,el:"wpac-rating",color:"fc6423"}),function(){if(!("WIDGETPACK_LOADED"in window)){WIDGETPACK_LOADED=!0;var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//embed.widgetpack.com/widget.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t.nextSibling)}}()</script><script src="/lib/pangu/dist/pangu.min.js?v=3.3"></script><script>pangu.spacingPage()</script><script src="/js/src/js.cookie.js?v=7.0.1"></script><script src="/js/src/scroll-cookie.js?v=7.0.1"></script><script src="/lib/bookmark/bookmark.min.js?v=1.0"></script><script>bookmark.scrollToMark("auto","#more")</script><style>.copy-btn{display:inline-block;padding:6px 12px;font-size:13px;font-weight:700;line-height:20px;color:#333;white-space:nowrap;vertical-align:middle;cursor:pointer;background-color:#eee;background-image:linear-gradient(#fcfcfc,#eee);border:1px solid #d5d5d5;border-radius:3px;user-select:none;outline:0}.highlight-wrap .copy-btn{transition:opacity .3s ease-in-out;opacity:0;padding:2px 6px;position:absolute;right:4px;top:8px}.highlight-wrap .copy-btn:focus,.highlight-wrap:hover .copy-btn{opacity:1}.highlight-wrap{position:relative}</style><script>$(".highlight").each(function(e,t){var n=$("<div>").addClass("highlight-wrap");$(t).after(n),n.append($("<button>").addClass("copy-btn").append("Copy").on("click",function(e){var t=$(this).parent().find(".code").find(".line").map(function(e,t){return $(t).text()}).toArray().join("\n"),n=document.createElement("textarea"),o=window.pageYOffset||document.documentElement.scrollTop;n.style.top=o+"px",n.style.position="absolute",n.style.opacity="0",n.readOnly=!0,n.value=t,document.body.appendChild(n),n.select(),n.setSelectionRange(0,t.length),n.readOnly=!1,document.execCommand("copy")?$(this).text("Copied"):$(this).text("Copy failed"),n.blur(),$(this).blur()})).on("mouseleave",function(e){var t=$(this).find(".copy-btn");setTimeout(function(){t.text("Copy")},300)}).append(t)})</script></body></html>